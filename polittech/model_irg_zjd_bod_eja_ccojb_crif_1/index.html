<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Вероятностная модель: Яарон Поппер vs Эрик Балтер</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Share+Tech+Mono&family=Rajdhani:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #020812;
    --bg2: #040f1e;
    --bg3: #071528;
    --neon-blue: #00d4ff;
    --neon-orange: #ff6b00;
    --neon-purple: #b300ff;
    --neon-green: #00ff88;
    --neon-red: #ff003c;
    --gold: #ffd700;
    --text: #c8e0f4;
    --muted: #4a6a8a;
    --card-bg: rgba(0, 212, 255, 0.03);
    --card-border: rgba(0, 212, 255, 0.15);
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'Rajdhani', sans-serif;
    font-size: 14px;
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* Animated background grid */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background-image: 
      linear-gradient(rgba(0,212,255,0.03) 1px, transparent 1px),
      linear-gradient(90deg, rgba(0,212,255,0.03) 1px, transparent 1px);
    background-size: 40px 40px;
    animation: gridMove 20s linear infinite;
    pointer-events: none;
    z-index: 0;
  }

  @keyframes gridMove {
    0% { transform: translateY(0); }
    100% { transform: translateY(40px); }
  }

  .container {
    position: relative;
    z-index: 1;
    max-width: 1400px;
    margin: 0 auto;
    padding: 20px;
  }

  /* HEADER */
  .header {
    text-align: center;
    padding: 40px 20px 30px;
    border-bottom: 1px solid var(--card-border);
    margin-bottom: 30px;
    position: relative;
  }

  .header::after {
    content: '';
    position: absolute;
    bottom: -1px;
    left: 50%;
    transform: translateX(-50%);
    width: 200px;
    height: 2px;
    background: var(--neon-blue);
    box-shadow: 0 0 20px var(--neon-blue);
  }

  .header-badge {
    font-family: 'Share Tech Mono', monospace;
    font-size: 11px;
    color: var(--neon-blue);
    letter-spacing: 4px;
    text-transform: uppercase;
    margin-bottom: 12px;
    opacity: 0.7;
  }

  .header h1 {
    font-family: 'Orbitron', sans-serif;
    font-size: clamp(20px, 3vw, 36px);
    font-weight: 900;
    color: #fff;
    text-shadow: 0 0 30px var(--neon-blue), 0 0 60px rgba(0,212,255,0.3);
    letter-spacing: 2px;
    line-height: 1.2;
    margin-bottom: 8px;
  }

  .header h1 span.vs {
    color: var(--neon-orange);
    text-shadow: 0 0 20px var(--neon-orange);
  }

  .header-sub {
    font-size: 13px;
    color: var(--muted);
    font-family: 'Share Tech Mono', monospace;
    letter-spacing: 2px;
  }

  /* LIVE PROBABILITY BAR */
  .prob-bar-section {
    background: var(--bg3);
    border: 1px solid var(--card-border);
    border-radius: 16px;
    padding: 24px 30px;
    margin-bottom: 30px;
    position: relative;
    overflow: hidden;
  }

  .prob-bar-section::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 2px;
    background: linear-gradient(90deg, var(--neon-blue), var(--neon-purple), var(--neon-orange));
    animation: shimmer 3s ease-in-out infinite;
  }

  @keyframes shimmer {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
  }

  .prob-label {
    font-family: 'Orbitron', monospace;
    font-size: 11px;
    letter-spacing: 3px;
    color: var(--muted);
    text-align: center;
    margin-bottom: 16px;
  }

  .prob-names {
    display: flex;
    justify-content: space-between;
    margin-bottom: 8px;
    font-family: 'Orbitron', sans-serif;
    font-size: 13px;
    font-weight: 700;
  }

  .prob-names .popper { color: var(--neon-blue); text-shadow: 0 0 10px var(--neon-blue); }
  .prob-names .balter { color: var(--neon-orange); text-shadow: 0 0 10px var(--neon-orange); }

  .prob-bar {
    width: 100%;
    height: 32px;
    background: rgba(255,107,0,0.15);
    border-radius: 16px;
    overflow: hidden;
    border: 1px solid rgba(255,107,0,0.2);
    position: relative;
  }

  .prob-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--neon-blue), #0088aa);
    border-radius: 16px;
    transition: width 0.5s ease;
    position: relative;
    overflow: hidden;
    display: flex;
    align-items: center;
    justify-content: flex-end;
    padding-right: 12px;
  }

  .prob-fill::after {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
    animation: sweep 2s ease-in-out infinite;
  }

  @keyframes sweep {
    0% { transform: translateX(-100%); }
    100% { transform: translateX(100%); }
  }

  .prob-numbers {
    display: flex;
    justify-content: space-between;
    margin-top: 10px;
    font-family: 'Share Tech Mono', monospace;
    font-size: 12px;
    color: var(--muted);
  }

  #live-popper { color: var(--neon-blue); font-weight: bold; font-size: 16px; }
  #live-balter { color: var(--neon-orange); font-weight: bold; font-size: 16px; }

  /* SLIDERS */
  .sliders-row {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 20px;
    margin-top: 20px;
  }

  .slider-group label {
    display: block;
    font-size: 11px;
    letter-spacing: 2px;
    color: var(--muted);
    font-family: 'Share Tech Mono', monospace;
    margin-bottom: 6px;
    text-transform: uppercase;
  }

  .slider-group input[type=range] {
    width: 100%;
    -webkit-appearance: none;
    height: 4px;
    border-radius: 2px;
    background: var(--muted);
    outline: none;
  }

  .slider-group input[type=range]::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 16px;
    height: 16px;
    border-radius: 50%;
    background: var(--neon-blue);
    box-shadow: 0 0 10px var(--neon-blue);
    cursor: pointer;
  }

  .slider-val {
    font-family: 'Orbitron', monospace;
    font-size: 13px;
    color: var(--neon-blue);
    text-align: right;
    margin-top: 4px;
  }

  /* SECTION HEADERS */
  .section-header {
    display: flex;
    align-items: center;
    gap: 16px;
    margin-bottom: 20px;
    padding-bottom: 12px;
    border-bottom: 1px solid var(--card-border);
  }

  .section-num {
    font-family: 'Orbitron', sans-serif;
    font-size: 11px;
    color: var(--bg);
    background: var(--neon-blue);
    width: 28px;
    height: 28px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 900;
    flex-shrink: 0;
  }

  .section-num.orange { background: var(--neon-orange); }
  .section-num.purple { background: var(--neon-purple); }
  .section-num.red { background: var(--neon-red); }
  .section-num.green { background: var(--neon-green); color: #000; }

  .section-title {
    font-family: 'Orbitron', sans-serif;
    font-size: 14px;
    font-weight: 700;
    letter-spacing: 2px;
    color: #fff;
  }

  /* CARDS GRID */
  .charts-grid {
    display: grid;
    gap: 20px;
    margin-bottom: 30px;
  }

  .charts-grid-2 { grid-template-columns: repeat(2, 1fr); }
  .charts-grid-3 { grid-template-columns: repeat(3, 1fr); }
  .charts-grid-4 { grid-template-columns: repeat(4, 1fr); }

  .chart-card {
    background: var(--card-bg);
    border: 1px solid var(--card-border);
    border-radius: 12px;
    padding: 20px;
    position: relative;
    overflow: hidden;
    transition: border-color 0.3s, box-shadow 0.3s;
  }

  .chart-card:hover {
    border-color: rgba(0,212,255,0.4);
    box-shadow: 0 0 30px rgba(0,212,255,0.08);
  }

  .chart-card-title {
    font-family: 'Share Tech Mono', monospace;
    font-size: 10px;
    letter-spacing: 2px;
    color: var(--muted);
    text-transform: uppercase;
    margin-bottom: 16px;
  }

  .chart-wrapper {
    position: relative;
    height: 200px;
  }

  .chart-wrapper.tall { height: 260px; }

  /* STAT BOXES */
  .stat-box {
    background: var(--card-bg);
    border: 1px solid var(--card-border);
    border-radius: 12px;
    padding: 20px;
    text-align: center;
  }

  .stat-num {
    font-family: 'Orbitron', sans-serif;
    font-size: 32px;
    font-weight: 900;
    line-height: 1;
    margin-bottom: 6px;
  }

  .stat-label {
    font-size: 11px;
    letter-spacing: 2px;
    color: var(--muted);
    font-family: 'Share Tech Mono', monospace;
    text-transform: uppercase;
  }

  /* TORNADO CHART */
  .tornado-bar-row {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 12px;
  }

  .tornado-label {
    width: 200px;
    font-size: 12px;
    text-align: right;
    color: var(--text);
    flex-shrink: 0;
  }

  .tornado-track {
    flex: 1;
    height: 28px;
    background: rgba(255,255,255,0.03);
    border-radius: 4px;
    position: relative;
    overflow: hidden;
  }

  .tornado-fill {
    position: absolute;
    top: 4px;
    height: 20px;
    border-radius: 3px;
  }

  .tornado-val {
    width: 50px;
    font-family: 'Share Tech Mono', monospace;
    font-size: 11px;
    color: var(--neon-blue);
  }

  /* HEATMAP */
  .heatmap-grid {
    display: grid;
    grid-template-columns: repeat(6, 1fr);
    gap: 3px;
  }

  .heatmap-cell {
    aspect-ratio: 1;
    border-radius: 3px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: 'Share Tech Mono', monospace;
    font-size: 9px;
    cursor: default;
    transition: transform 0.2s;
  }

  .heatmap-cell:hover { transform: scale(1.2); z-index: 10; }

  /* FUNNEL */
  .funnel-step {
    position: relative;
    margin-bottom: 4px;
    display: flex;
    align-items: center;
    gap: 12px;
  }

  .funnel-bar {
    height: 40px;
    border-radius: 4px;
    display: flex;
    align-items: center;
    padding: 0 16px;
    font-family: 'Orbitron', sans-serif;
    font-size: 12px;
    font-weight: 700;
    transition: width 1s ease;
    position: relative;
    overflow: hidden;
  }

  .funnel-bar::after {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.08), transparent);
    animation: sweep 3s ease-in-out infinite;
  }

  .funnel-meta {
    font-size: 12px;
    color: var(--muted);
    white-space: nowrap;
    font-family: 'Share Tech Mono', monospace;
  }

  /* PROBABILITY LADDER */
  .ladder {
    display: flex;
    flex-direction: column;
    gap: 16px;
    padding: 10px 0;
  }

  .ladder-step {
    display: flex;
    align-items: center;
    gap: 16px;
  }

  .ladder-circle {
    width: 56px;
    height: 56px;
    border-radius: 50%;
    border: 2px solid;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: 'Orbitron', sans-serif;
    font-size: 13px;
    font-weight: 700;
    flex-shrink: 0;
  }

  .ladder-info h4 {
    font-size: 13px;
    font-family: 'Rajdhani', sans-serif;
    font-weight: 600;
    margin-bottom: 2px;
  }

  .ladder-info p {
    font-size: 11px;
    color: var(--muted);
    font-family: 'Share Tech Mono', monospace;
  }

  .ladder-connector {
    width: 2px;
    height: 16px;
    margin-left: 27px;
    background: linear-gradient(to bottom, rgba(0,212,255,0.5), transparent);
  }

  /* SECTION WRAPPER */
  .section-block {
    margin-bottom: 40px;
    background: rgba(0,10,25,0.6);
    border-radius: 16px;
    padding: 24px;
    border: 1px solid rgba(0,212,255,0.07);
  }

  /* Monte Carlo */
  .mc-result-boxes {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 16px;
    margin-bottom: 20px;
  }

  .mc-box {
    border-radius: 12px;
    padding: 20px;
    text-align: center;
    border: 1px solid;
  }

  /* Scenario range */
  .scenario-track {
    width: 100%;
    height: 48px;
    background: rgba(255,255,255,0.03);
    border-radius: 8px;
    position: relative;
    margin: 20px 0 10px;
  }

  .scenario-fill {
    position: absolute;
    top: 8px;
    height: 32px;
    background: linear-gradient(90deg, rgba(0,212,255,0.3), rgba(0,212,255,0.7));
    border-radius: 6px;
    border: 1px solid rgba(0,212,255,0.5);
  }

  .scenario-marker {
    position: absolute;
    top: -24px;
    transform: translateX(-50%);
    font-family: 'Share Tech Mono', monospace;
    font-size: 10px;
    color: var(--neon-blue);
    text-align: center;
    white-space: nowrap;
  }

  .scenario-dot {
    position: absolute;
    top: 50%;
    transform: translate(-50%, -50%);
    width: 12px;
    height: 12px;
    border-radius: 50%;
    border: 2px solid var(--bg);
  }

  .scenario-labels {
    display: flex;
    justify-content: space-between;
    font-family: 'Share Tech Mono', monospace;
    font-size: 10px;
    color: var(--muted);
  }

  /* FOOTER */
  .footer {
    text-align: center;
    padding: 30px;
    border-top: 1px solid var(--card-border);
    font-family: 'Share Tech Mono', monospace;
    font-size: 10px;
    color: var(--muted);
    letter-spacing: 2px;
  }

  /* ANIM */
  @keyframes fadeInUp {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .section-block {
    animation: fadeInUp 0.6s ease both;
  }

  .section-block:nth-child(1) { animation-delay: 0.1s; }
  .section-block:nth-child(2) { animation-delay: 0.2s; }
  .section-block:nth-child(3) { animation-delay: 0.3s; }
  .section-block:nth-child(4) { animation-delay: 0.4s; }
  .section-block:nth-child(5) { animation-delay: 0.5s; }

  @media (max-width: 900px) {
    .charts-grid-4 { grid-template-columns: repeat(2, 1fr); }
    .charts-grid-3 { grid-template-columns: 1fr 1fr; }
    .charts-grid-2 { grid-template-columns: 1fr; }
    .sliders-row { grid-template-columns: 1fr; }
    .mc-result-boxes { grid-template-columns: 1fr; }
  }

  @media (max-width: 600px) {
    .charts-grid-4, .charts-grid-3, .charts-grid-2 { grid-template-columns: 1fr; }
    .tornado-label { width: 120px; font-size: 10px; }
  }

  .pulse {
    animation: pulse 2s ease-in-out infinite;
  }

  @keyframes pulse {
    0%, 100% { box-shadow: 0 0 0 0 rgba(0,212,255,0.3); }
    50% { box-shadow: 0 0 0 8px rgba(0,212,255,0); }
  }
</style>
</head>
<body>
<div class="container">

  <!-- HEADER -->
  <div class="header">
    <div class="header-badge">◆ ПОЛИТИЧЕСКИЙ АНАЛИТИЧЕСКИЙ ЦЕНТР ◆ ПРОГНОЗ НА 4 ГОДА ◆</div>
    <h1>ЯАРОН ПОППЕР <span class="vs">vs</span> ЭРИК БАЛТЕР</h1>
    <div class="header-sub">ВЕРОЯТНОСТНАЯ МОДЕЛЬ ЛИДЕРСТВА · МОНТЕ-КАРЛО · 10 000 СИМУЛЯЦИЙ</div>
  </div>

  <!-- LIVE PROBABILITY BAR -->
  <div class="prob-bar-section">
    <div class="prob-label">▶ LIVE — ВЕРОЯТНОСТЬ ПОБЕДЫ (С УЧЁТОМ СЛАЙДЕРОВ)</div>
    <div class="prob-names">
      <span class="popper">ЯАРОН ПОППЕР &nbsp;<span id="live-popper">63.8%</span></span>
      <span class="balter"><span id="live-balter">31.4%</span>&nbsp; ЭРИК БАЛТЕР</span>
    </div>
    <div class="prob-bar">
      <div class="prob-fill" id="prob-fill" style="width:63.8%">
      </div>
    </div>
    <div class="prob-numbers">
      <span>ЯВКА:</span>
      <span>РАСПОЗНАВАЕМОСТЬ:</span>
      <span>ИНСТИТУЦИОНАЛЬНЫЙ КОНТРОЛЬ:</span>
    </div>

    <div class="sliders-row">
      <div class="slider-group">
        <label>Явка избирателей</label>
        <input type="range" id="s-turnout" min="40" max="60" value="50" oninput="updateSliders()">
        <div class="slider-val" id="v-turnout">50%</div>
      </div>
      <div class="slider-group">
        <label>Распознаваемость Поппера</label>
        <input type="range" id="s-recog" min="60" max="100" value="90" oninput="updateSliders()">
        <div class="slider-val" id="v-recog">0.90</div>
      </div>
      <div class="slider-group">
        <label>Институциональный контроль Балтера</label>
        <input type="range" id="s-inst" min="30" max="80" value="50" oninput="updateSliders()">
        <div class="slider-val" id="v-inst">0.50</div>
      </div>
    </div>
  </div>

  <!-- SECTION 1 -->
  <div class="section-block">
    <div class="section-header">
      <div class="section-num">1</div>
      <div class="section-title">СТРУКТУРА ЭЛЕКТОРАТА</div>
    </div>

    <div class="charts-grid charts-grid-4" style="margin-bottom:16px;">
      <div class="stat-box">
        <div class="stat-num" style="color:var(--neon-blue)">8K–30K</div>
        <div class="stat-label">Размер сообщества</div>
      </div>
      <div class="stat-box">
        <div class="stat-num" style="color:var(--neon-green)">40–60%</div>
        <div class="stat-label">Ожидаемая явка</div>
      </div>
      <div class="stat-box">
        <div class="stat-num" style="color:var(--neon-orange)">15.4%</div>
        <div class="stat-label">Доля родителей</div>
      </div>
      <div class="stat-box">
        <div class="stat-num" style="color:var(--neon-purple)">3.2K–18K</div>
        <div class="stat-label">Активных избирателей</div>
      </div>
    </div>

    <div class="charts-grid charts-grid-2">
      <div class="chart-card">
        <div class="chart-card-title">Распределение явки (%)</div>
        <div class="chart-wrapper">
          <canvas id="c1"></canvas>
        </div>
      </div>
      <div class="chart-card">
        <div class="chart-card-title">Демографический состав электората</div>
        <div class="chart-wrapper">
          <canvas id="c3"></canvas>
        </div>
      </div>
    </div>
  </div>

  <!-- SECTION 2 -->
  <div class="section-block">
    <div class="section-header">
      <div class="section-num orange">2</div>
      <div class="section-title">СРАВНЕНИЕ ПОКАЗАТЕЛЕЙ ЛИДЕРСТВА</div>
    </div>

    <div class="charts-grid charts-grid-2" style="margin-bottom:16px;">
      <div class="chart-card">
        <div class="chart-card-title">Рост распознаваемости: Поппер (0.25 → 0.90)</div>
        <div class="chart-wrapper">
          <canvas id="c5"></canvas>
        </div>
      </div>
      <div class="chart-card">
        <div class="chart-card-title">Сравнение ораторских способностей</div>
        <div class="chart-wrapper">
          <canvas id="c6"></canvas>
        </div>
      </div>
    </div>

    <div class="charts-grid charts-grid-2">
      <div class="chart-card">
        <div class="chart-card-title">Институциональный контроль: снижение Балтера</div>
        <div class="chart-wrapper">
          <canvas id="c7"></canvas>
        </div>
      </div>
      <div class="chart-card">
        <div class="chart-card-title">Сводный индекс лидерства</div>
        <div class="chart-wrapper">
          <canvas id="c8"></canvas>
        </div>
      </div>
    </div>
  </div>

  <!-- SECTION 3 -->
  <div class="section-block">
    <div class="section-header">
      <div class="section-num purple">3</div>
      <div class="section-title">СИМУЛЯЦИЯ МОНТЕ-КАРЛО · 10 000 ПРОГОНОВ</div>
    </div>

    <div class="mc-result-boxes">
      <div class="mc-box pulse" style="background:rgba(0,212,255,0.06); border-color:var(--neon-blue);">
        <div style="font-family:'Orbitron',sans-serif; font-size:42px; font-weight:900; color:var(--neon-blue); text-shadow:0 0 20px var(--neon-blue);" id="mc-popper">63.8%</div>
        <div style="font-size:13px; letter-spacing:2px; color:var(--muted); font-family:'Share Tech Mono',monospace; margin-top:6px;">ЯАРОН ПОППЕР</div>
      </div>
      <div class="mc-box" style="background:rgba(255,107,0,0.06); border-color:var(--neon-orange);">
        <div style="font-family:'Orbitron',sans-serif; font-size:42px; font-weight:900; color:var(--neon-orange); text-shadow:0 0 20px var(--neon-orange);" id="mc-balter">31.4%</div>
        <div style="font-size:13px; letter-spacing:2px; color:var(--muted); font-family:'Share Tech Mono',monospace; margin-top:6px;">ЭРИК БАЛТЕР</div>
      </div>
      <div class="mc-box" style="background:rgba(179,0,255,0.06); border-color:var(--neon-purple);">
        <div style="font-family:'Orbitron',sans-serif; font-size:42px; font-weight:900; color:var(--neon-purple); text-shadow:0 0 20px var(--neon-purple);">4.8%</div>
        <div style="font-size:13px; letter-spacing:2px; color:var(--muted); font-family:'Share Tech Mono',monospace; margin-top:6px;">ДРУГИЕ КАНДИДАТЫ</div>
      </div>
    </div>

    <div class="charts-grid charts-grid-2">
      <div class="chart-card">
        <div class="chart-card-title">Гистограмма Монте-Карло: победные исходы</div>
        <div class="chart-wrapper tall">
          <canvas id="c9"></canvas>
        </div>
      </div>
      <div class="chart-card">
        <div class="chart-card-title">Сценарные диапазоны вероятности победы</div>
        <div style="padding: 20px 0;">
          <div style="margin-bottom:24px;">
            <div style="font-family:'Share Tech Mono',monospace; font-size:11px; color:var(--muted); margin-bottom:6px;">ЯАРОН ПОППЕР</div>
            <div class="scenario-track">
              <div class="scenario-fill" style="left:42%; width:32%;"></div>
              <div class="scenario-dot" style="left:42%; background:#ff6b00; top:50%; transform:translate(-50%,-50%);"></div>
              <div class="scenario-dot" style="left:64%; background:var(--neon-blue); top:50%; transform:translate(-50%,-50%);"></div>
              <div class="scenario-dot" style="left:74%; background:var(--neon-green); top:50%; transform:translate(-50%,-50%);"></div>
              <div class="scenario-marker" style="left:42%; color:var(--neon-orange);">52%<br>Пессимистичный</div>
              <div class="scenario-marker" style="left:64%; color:var(--neon-blue);">64%<br>Базовый</div>
              <div class="scenario-marker" style="left:74%; color:var(--neon-green);">74%<br>Оптимистичный</div>
            </div>
            <div class="scenario-labels"><span>40%</span><span>60%</span><span>80%</span></div>
          </div>
          <div style="margin-top:40px;">
            <div style="font-family:'Share Tech Mono',monospace; font-size:11px; color:var(--muted); margin-bottom:6px;">КРИВАЯ ПЛОТНОСТИ ВЕРОЯТНОСТИ</div>
            <div class="chart-wrapper" style="height:160px;">
              <canvas id="c11"></canvas>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- SECTION 4 -->
  <div class="section-block">
    <div class="section-header">
      <div class="section-num red">4</div>
      <div class="section-title">АНАЛИЗ ЧУВСТВИТЕЛЬНОСТИ</div>
    </div>

    <div class="charts-grid charts-grid-2">
      <div class="chart-card">
        <div class="chart-card-title">Диаграмма-торнадо: ключевые факторы влияния</div>
        <div style="padding: 10px 0;">
          <div class="tornado-bar-row">
            <div class="tornado-label">Распознаваемость</div>
            <div class="tornado-track">
              <div class="tornado-fill" style="background:var(--neon-blue); left:0; width:90%; animation: fadeInUp 1s 0.2s both;"></div>
            </div>
            <div class="tornado-val">±22%</div>
          </div>
          <div class="tornado-bar-row">
            <div class="tornado-label">Институциональный контроль</div>
            <div class="tornado-track">
              <div class="tornado-fill" style="background:var(--neon-orange); left:0; width:68%;"></div>
            </div>
            <div class="tornado-val">±17%</div>
          </div>
          <div class="tornado-bar-row">
            <div class="tornado-label">Фрагментация кандидатов</div>
            <div class="tornado-track">
              <div class="tornado-fill" style="background:var(--neon-purple); left:0; width:45%;"></div>
            </div>
            <div class="tornado-val">±11%</div>
          </div>
          <div class="tornado-bar-row">
            <div class="tornado-label">Явка избирателей</div>
            <div class="tornado-track">
              <div class="tornado-fill" style="background:var(--neon-green); left:0; width:30%;"></div>
            </div>
            <div class="tornado-val">±8%</div>
          </div>
          <div class="tornado-bar-row">
            <div class="tornado-label">Недовольство родителей</div>
            <div class="tornado-track">
              <div class="tornado-fill" style="background:var(--gold); left:0; width:20%;"></div>
            </div>
            <div class="tornado-val">±5%</div>
          </div>
        </div>
      </div>

      <div class="chart-card">
        <div class="chart-card-title">Тепловая карта: Распознаваемость vs Институциональный контроль</div>
        <div style="padding: 10px 0;">
          <div style="display:flex; gap:8px; align-items:flex-start;">
            <div style="font-family:'Share Tech Mono',monospace; font-size:9px; color:var(--muted); writing-mode:vertical-lr; transform:rotate(180deg); padding-top:10px;">ИНСТИТУЦИОНАЛЬНЫЙ КОНТРОЛЬ</div>
            <div style="flex:1;">
              <div id="heatmap" class="heatmap-grid"></div>
              <div style="font-family:'Share Tech Mono',monospace; font-size:9px; color:var(--muted); text-align:center; margin-top:6px;">РАСПОЗНАВАЕМОСТЬ →</div>
            </div>
          </div>
          <div style="display:flex; gap:4px; align-items:center; margin-top:10px; justify-content:center;">
            <div style="width:12px;height:12px;background:#ff003c;border-radius:2px;"></div>
            <span style="font-size:10px;color:var(--muted);margin-right:8px;">50%</span>
            <div style="width:60px;height:8px;background:linear-gradient(90deg,#ff003c,#ffd700,#00ff88);border-radius:4px;"></div>
            <div style="width:12px;height:12px;background:#00ff88;border-radius:2px;"></div>
            <span style="font-size:10px;color:var(--muted);">74%</span>
          </div>
        </div>
      </div>
    </div>

    <div class="chart-card" style="margin-top:16px;">
      <div class="chart-card-title">Влияние количества кандидатов на вероятность победы Поппера</div>
      <div class="chart-wrapper" style="height:160px;">
        <canvas id="c14"></canvas>
      </div>
    </div>
  </div>

  <!-- SECTION 5 -->
  <div class="section-block">
    <div class="section-header">
      <div class="section-num green">5</div>
      <div class="section-title">КАРЬЕРНАЯ ЛЕСТНИЦА: ПРОГНОЗ ПРОДВИЖЕНИЯ</div>
    </div>

    <div class="charts-grid charts-grid-2">
      <div class="chart-card">
        <div class="chart-card-title">Иерархическая лестница вероятности</div>
        <div class="ladder">
          <div class="ladder-step">
            <div class="ladder-circle" style="border-color:var(--neon-blue); color:var(--neon-blue); box-shadow:0 0 15px rgba(0,212,255,0.3);">64%</div>
            <div class="ladder-info">
              <h4>ШАГ 1 — Председатель местного уровня</h4>
              <p>Победа на выборах · Базовый сценарий</p>
            </div>
          </div>
          <div class="ladder-connector"></div>
          <div class="ladder-step">
            <div class="ladder-circle" style="border-color:var(--neon-purple); color:var(--neon-purple); box-shadow:0 0 15px rgba(179,0,255,0.3);">55%</div>
            <div class="ladder-info">
              <h4>ШАГ 2 — Региональный Высший Совет</h4>
              <p>Условная вероятность · Итого: 35%</p>
            </div>
          </div>
          <div class="ladder-connector"></div>
          <div class="ladder-step">
            <div class="ladder-circle" style="border-color:var(--neon-green); color:var(--neon-green); box-shadow:0 0 15px rgba(0,255,136,0.3);">35%</div>
            <div class="ladder-info">
              <h4>ШАГ 3 — Национальный Совет</h4>
              <p>Условная вероятность · Итого: 12%</p>
            </div>
          </div>
        </div>
      </div>

      <div class="chart-card">
        <div class="chart-card-title">Воронка карьерных вероятностей</div>
        <div style="padding: 20px 0;">
          <div class="funnel-step">
            <div class="funnel-bar" style="width:100%; background:linear-gradient(90deg, rgba(0,212,255,0.3), rgba(0,212,255,0.15)); color:var(--neon-blue); border:1px solid rgba(0,212,255,0.4);">
              КАНДИДАТ — 100%
            </div>
          </div>
          <div style="margin: 4px 0 4px 20px; width:2px; height:16px; background:rgba(0,212,255,0.3);"></div>
          <div class="funnel-step">
            <div class="funnel-bar" style="width:64%; background:linear-gradient(90deg, rgba(0,212,255,0.5), rgba(0,212,255,0.25)); color:#fff; border:1px solid rgba(0,212,255,0.6);">
              ПОБЕДА — 64%
            </div>
          </div>
          <div style="margin: 4px 0 4px 20px; width:2px; height:16px; background:rgba(179,0,255,0.4);"></div>
          <div class="funnel-step">
            <div class="funnel-bar" style="width:35%; background:linear-gradient(90deg, rgba(179,0,255,0.5), rgba(179,0,255,0.25)); color:#fff; border:1px solid rgba(179,0,255,0.5);">
              РЕГИОНАЛЬНЫЙ — 35%
            </div>
          </div>
          <div style="margin: 4px 0 4px 20px; width:2px; height:16px; background:rgba(0,255,136,0.4);"></div>
          <div class="funnel-step">
            <div class="funnel-bar" style="width:12%; background:linear-gradient(90deg, rgba(0,255,136,0.6), rgba(0,255,136,0.3)); color:#fff; border:1px solid rgba(0,255,136,0.5); min-width:80px;">
              НАЦ — 12%
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="chart-card" style="margin-top:16px;">
      <div class="chart-card-title">Кумулятивная вероятность карьерной траектории</div>
      <div class="chart-wrapper" style="height:200px;">
        <canvas id="c16"></canvas>
      </div>
    </div>
  </div>

  <div class="footer">
    ◆ ПОЛИТИЧЕСКИЙ АНАЛИТИЧЕСКИЙ ЦЕНТР ◆ ВЕРОЯТНОСТНАЯ МОДЕЛЬ v2.4 ◆ МОНТЕ-КАРЛО 10 000 СИМУЛЯЦИЙ ◆ ГОРИЗОНТ ПРОГНОЗА: 4 ГОДА ◆
  </div>
</div>

<script>
// Utility
const neonBlue = '#00d4ff';
const neonOrange = '#ff6b00';
const neonPurple = '#b300ff';
const neonGreen = '#00ff88';
const neonRed = '#ff003c';
const gold = '#ffd700';

Chart.defaults.color = '#4a6a8a';
Chart.defaults.font.family = "'Share Tech Mono', monospace";
Chart.defaults.font.size = 10;

function makeGradient(ctx, c1, c2, vert=true) {
  const g = vert
    ? ctx.createLinearGradient(0, 0, 0, ctx.canvas.height)
    : ctx.createLinearGradient(0, 0, ctx.canvas.width, 0);
  g.addColorStop(0, c1);
  g.addColorStop(1, c2);
  return g;
}

// Chart 1 — Turnout distribution (bell curve approximation)
const c1 = document.getElementById('c1').getContext('2d');
const turnoutLabels = ['35%','38%','40%','42%','44%','46%','48%','50%','52%','54%','56%','58%','60%','62%','65%'];
const turnoutData = [1,3,8,18,35,60,85,100,85,60,35,18,8,3,1];
new Chart(c1, {
  type: 'line',
  data: {
    labels: turnoutLabels,
    datasets: [{
      data: turnoutData,
      borderColor: neonBlue,
      backgroundColor: 'rgba(0,212,255,0.1)',
      borderWidth: 2,
      fill: true,
      tension: 0.4,
      pointRadius: 0,
    }]
  },
  options: {
    responsive: true, maintainAspectRatio: false,
    plugins: { legend: { display: false } },
    scales: {
      x: { grid: { color: 'rgba(255,255,255,0.04)' }, ticks: { maxTicksLimit: 7 } },
      y: { grid: { color: 'rgba(255,255,255,0.04)' }, display: false }
    },
    animation: { duration: 1500, easing: 'easeInOutQuart' }
  }
});

// Chart 3 — Demographic pie
const c3 = document.getElementById('c3').getContext('2d');
new Chart(c3, {
  type: 'doughnut',
  data: {
    labels: ['Родители (15.4%)', 'Остальные (84.6%)'],
    datasets: [{
      data: [15.4, 84.6],
      backgroundColor: ['rgba(0,212,255,0.7)', 'rgba(179,0,255,0.3)'],
      borderColor: [neonBlue, neonPurple],
      borderWidth: 2,
      hoverOffset: 8
    }]
  },
  options: {
    responsive: true, maintainAspectRatio: false,
    plugins: {
      legend: { position: 'bottom', labels: { color: '#4a6a8a', padding: 16, font: { size: 11 } } }
    },
    animation: { animateRotate: true, duration: 1500 }
  }
});

// Chart 5 — Recognition growth
const c5 = document.getElementById('c5').getContext('2d');
const years = ['Сейчас', '1 год', '2 года', '3 года', '4 года'];
const popperGrowth = [0.25, 0.45, 0.63, 0.78, 0.90];
const balterFlat = [0.55, 0.53, 0.51, 0.50, 0.48];
new Chart(c5, {
  type: 'line',
  data: {
    labels: years,
    datasets: [
      {
        label: 'Поппер',
        data: popperGrowth,
        borderColor: neonBlue,
        backgroundColor: 'rgba(0,212,255,0.1)',
        borderWidth: 3,
        fill: true,
        tension: 0.4,
        pointBackgroundColor: neonBlue,
        pointRadius: 4,
      },
      {
        label: 'Балтер',
        data: balterFlat,
        borderColor: neonOrange,
        backgroundColor: 'rgba(255,107,0,0.05)',
        borderWidth: 2,
        fill: true,
        tension: 0.4,
        pointBackgroundColor: neonOrange,
        pointRadius: 4,
        borderDash: [5,3]
      }
    ]
  },
  options: {
    responsive: true, maintainAspectRatio: false,
    plugins: { legend: { position: 'bottom', labels: { color: '#4a6a8a', font: { size: 10 } } } },
    scales: {
      x: { grid: { color: 'rgba(255,255,255,0.04)' } },
      y: { min: 0, max: 1, grid: { color: 'rgba(255,255,255,0.04)' }, ticks: { callback: v => v.toFixed(2) } }
    },
    animation: { duration: 1500 }
  }
});

// Chart 6 — Speech comparison
const c6 = document.getElementById('c6').getContext('2d');
new Chart(c6, {
  type: 'bar',
  data: {
    labels: ['Ораторское\nмастерство', 'Кампания', 'Престиж', 'Институциональный\nконтроль'],
    datasets: [
      {
        label: 'Поппер',
        data: [1.0, 0.8, 0.45, 0.30],
        backgroundColor: 'rgba(0,212,255,0.6)',
        borderColor: neonBlue,
        borderWidth: 1,
        borderRadius: 4,
      },
      {
        label: 'Балтер',
        data: [0.4, 0.5, 0.60, 0.70],
        backgroundColor: 'rgba(255,107,0,0.6)',
        borderColor: neonOrange,
        borderWidth: 1,
        borderRadius: 4,
      }
    ]
  },
  options: {
    responsive: true, maintainAspectRatio: false,
    plugins: { legend: { position: 'bottom', labels: { color: '#4a6a8a', font: { size: 10 } } } },
    scales: {
      x: { grid: { display: false } },
      y: { min: 0, max: 1.1, grid: { color: 'rgba(255,255,255,0.04)' } }
    },
    animation: { duration: 1500 }
  }
});

// Chart 7 — Institutional control decline
const c7 = document.getElementById('c7').getContext('2d');
new Chart(c7, {
  type: 'line',
  data: {
    labels: years,
    datasets: [{
      label: 'Балтер: институциональный контроль',
      data: [0.70, 0.65, 0.58, 0.53, 0.50],
      borderColor: neonRed,
      backgroundColor: 'rgba(255,0,60,0.08)',
      borderWidth: 2,
      fill: true,
      tension: 0.3,
      pointBackgroundColor: neonRed,
      pointRadius: 4,
    }]
  },
  options: {
    responsive: true, maintainAspectRatio: false,
    plugins: { legend: { position: 'bottom', labels: { color: '#4a6a8a', font: { size: 10 } } } },
    scales: {
      x: { grid: { color: 'rgba(255,255,255,0.04)' } },
      y: { min: 0, max: 1, grid: { color: 'rgba(255,255,255,0.04)' } }
    },
    animation: { duration: 1500 }
  }
});

// Chart 8 — Composite leadership
const c8 = document.getElementById('c8').getContext('2d');
new Chart(c8, {
  type: 'radar',
  data: {
    labels: ['Распознаваемость', 'Ораторство', 'Кампания', 'Престиж', 'Контроль'],
    datasets: [
      {
        label: 'Поппер (4 года)',
        data: [0.90, 1.0, 0.80, 0.75, 0.30],
        backgroundColor: 'rgba(0,212,255,0.15)',
        borderColor: neonBlue,
        borderWidth: 2,
        pointBackgroundColor: neonBlue,
      },
      {
        label: 'Балтер (4 года)',
        data: [0.48, 0.40, 0.50, 0.65, 0.50],
        backgroundColor: 'rgba(255,107,0,0.1)',
        borderColor: neonOrange,
        borderWidth: 2,
        pointBackgroundColor: neonOrange,
      }
    ]
  },
  options: {
    responsive: true, maintainAspectRatio: false,
    plugins: { legend: { position: 'bottom', labels: { color: '#4a6a8a', font: { size: 10 } } } },
    scales: {
      r: {
        min: 0, max: 1,
        grid: { color: 'rgba(255,255,255,0.07)' },
        angleLines: { color: 'rgba(255,255,255,0.07)' },
        ticks: { display: false },
        pointLabels: { color: '#4a6a8a', font: { size: 10 } }
      }
    },
    animation: { duration: 1500 }
  }
});

// Chart 9 — Monte Carlo histogram
const c9 = document.getElementById('c9').getContext('2d');
const bins = Array.from({length:20}, (_,i) => `${40+i*2}–${42+i*2}%`);
function gaussianBins(center, spread) {
  return Array.from({length:20}, (_,i) => {
    const x = 40 + i*2 + 1;
    return Math.round(1200 * Math.exp(-0.5 * ((x - center)/spread)**2));
  });
}
new Chart(c9, {
  type: 'bar',
  data: {
    labels: bins,
    datasets: [
      {
        label: 'Поппер',
        data: gaussianBins(63.8, 7),
        backgroundColor: 'rgba(0,212,255,0.5)',
        borderColor: neonBlue,
        borderWidth: 1,
        borderRadius: 2,
      },
      {
        label: 'Балтер',
        data: gaussianBins(31.4, 6),
        backgroundColor: 'rgba(255,107,0,0.35)',
        borderColor: neonOrange,
        borderWidth: 1,
        borderRadius: 2,
      }
    ]
  },
  options: {
    responsive: true, maintainAspectRatio: false,
    plugins: { legend: { position: 'bottom', labels: { color: '#4a6a8a', font: { size: 10 } } } },
    scales: {
      x: { grid: { display: false }, ticks: { maxTicksLimit: 7 } },
      y: { grid: { color: 'rgba(255,255,255,0.04)' }, ticks: { display: false } }
    },
    animation: { duration: 1800 }
  }
});

// Chart 11 — Probability density curve
const c11 = document.getElementById('c11').getContext('2d');
const xVals = Array.from({length:60}, (_,i) => 40 + i);
function normal(x, mu, sigma) { return Math.exp(-0.5*((x-mu)/sigma)**2)/(sigma*Math.sqrt(2*Math.PI)); }
new Chart(c11, {
  type: 'line',
  data: {
    labels: xVals,
    datasets: [
      {
        label: 'Поппер',
        data: xVals.map(x => normal(x, 63.8, 7)),
        borderColor: neonBlue,
        backgroundColor: 'rgba(0,212,255,0.1)',
        borderWidth: 2,
        fill: true,
        tension: 0.4,
        pointRadius: 0,
      },
      {
        label: 'Балтер',
        data: xVals.map(x => normal(x, 31.4, 6)),
        borderColor: neonOrange,
        backgroundColor: 'rgba(255,107,0,0.08)',
        borderWidth: 2,
        fill: true,
        tension: 0.4,
        pointRadius: 0,
      }
    ]
  },
  options: {
    responsive: true, maintainAspectRatio: false,
    plugins: { legend: { display: false } },
    scales: {
      x: { grid: { color: 'rgba(255,255,255,0.03)' }, ticks: { maxTicksLimit: 7, callback: v => v + '%' } },
      y: { display: false }
    },
    animation: { duration: 1500 }
  }
});

// Heatmap
const hm = document.getElementById('heatmap');
const recogVals = [0.65, 0.70, 0.75, 0.80, 0.85, 0.90];
const instVals = [0.70, 0.65, 0.60, 0.55, 0.50, 0.45];
for (let ri = 0; ri < instVals.length; ri++) {
  for (let ci = 0; ci < recogVals.length; ci++) {
    const r = recogVals[ci];
    const ic = instVals[ri];
    const prob = Math.min(74, Math.max(48, 35 + r*40 - ic*20 + Math.random()*2));
    const t = (prob - 48) / 26;
    const red = Math.round(255 * (1-t));
    const green = Math.round(255 * t);
    const cell = document.createElement('div');
    cell.className = 'heatmap-cell';
    cell.style.background = `rgba(${red},${green},50,0.7)`;
    cell.style.color = prob > 61 ? '#000' : '#fff';
    cell.textContent = prob.toFixed(0) + '%';
    cell.title = `Распознав: ${r}, Контроль: ${ic} → ${prob.toFixed(1)}%`;
    hm.appendChild(cell);
  }
}

// Chart 14 — Candidate fragmentation
const c14 = document.getElementById('c14').getContext('2d');
new Chart(c14, {
  type: 'line',
  data: {
    labels: ['3', '4', '5', '6', '7', '8'],
    datasets: [{
      label: 'Вероятность победы Поппера',
      data: [70, 67, 64, 60, 57, 54],
      borderColor: neonBlue,
      backgroundColor: 'rgba(0,212,255,0.1)',
      borderWidth: 2,
      fill: true,
      tension: 0.3,
      pointBackgroundColor: neonBlue,
      pointRadius: 5,
    }]
  },
  options: {
    responsive: true, maintainAspectRatio: false,
    plugins: { legend: { display: false } },
    scales: {
      x: { grid: { color: 'rgba(255,255,255,0.04)' }, title: { display: true, text: 'Количество кандидатов', color: '#4a6a8a', font: { size: 10 } } },
      y: { min: 45, max: 80, grid: { color: 'rgba(255,255,255,0.04)' }, ticks: { callback: v => v + '%' } }
    },
    animation: { duration: 1500 }
  }
});

// Chart 16 — Career probability
const c16 = document.getElementById('c16').getContext('2d');
new Chart(c16, {
  type: 'bar',
  data: {
    labels: ['Победа на выборах', 'Региональный уровень', 'Национальный уровень'],
    datasets: [{
      data: [64, 35, 12],
      backgroundColor: [
        'rgba(0,212,255,0.6)',
        'rgba(179,0,255,0.6)',
        'rgba(0,255,136,0.6)',
      ],
      borderColor: [neonBlue, neonPurple, neonGreen],
      borderWidth: 2,
      borderRadius: 6,
    }]
  },
  options: {
    responsive: true, maintainAspectRatio: false,
    plugins: { legend: { display: false } },
    scales: {
      x: { grid: { display: false } },
      y: { min: 0, max: 80, grid: { color: 'rgba(255,255,255,0.04)' }, ticks: { callback: v => v + '%' } }
    },
    animation: { duration: 1500 }
  }
});

// SLIDER LOGIC
function updateSliders() {
  const turnout = parseInt(document.getElementById('s-turnout').value);
  const recog = parseInt(document.getElementById('s-recog').value) / 100;
  const inst = parseInt(document.getElementById('s-inst').value) / 100;

  document.getElementById('v-turnout').textContent = turnout + '%';
  document.getElementById('v-recog').textContent = recog.toFixed(2);
  document.getElementById('v-inst').textContent = inst.toFixed(2);

  // Simplified probability formula
  const turnoutFactor = (turnout - 40) / 20; // 0 to 1
  let prob = 35 + recog * 40 - inst * 20 + turnoutFactor * 5;
  prob = Math.min(78, Math.max(45, prob));
  const balterProb = Math.max(20, Math.min(45, 100 - prob - 5));
  const otherProb = (100 - prob - balterProb).toFixed(1);

  document.getElementById('live-popper').textContent = prob.toFixed(1) + '%';
  document.getElementById('live-balter').textContent = balterProb.toFixed(1) + '%';
  document.getElementById('prob-fill').style.width = prob + '%';
  document.getElementById('mc-popper').textContent = prob.toFixed(1) + '%';
  document.getElementById('mc-balter').textContent = balterProb.toFixed(1) + '%';
}
</script>
</body>
</html>
